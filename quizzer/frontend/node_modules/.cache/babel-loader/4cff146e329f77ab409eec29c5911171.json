{"ast":null,"code":"import _slicedToArray from\"C:/Users/Stephen/OneDrive/Desktop/PD/quizzer/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import MainChat from'./MainChat';import Members from'./Members';import{getServerData,CreateNewCategory,CreateNewChannel,LeaveServer}from'../services/Servers';import{SendNewInvitation}from'../services/notifications';import QuizCategories from'../quiz/QuizCategories.jsx';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Server(props){var _this=this;var _useState=useState(),_useState2=_slicedToArray(_useState,2),serverDetail=_useState2[0],setServerDetail=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),dataLoaded=_useState4[0],setDataLoaded=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isAdmin=_useState6[0],setIsAdmin=_useState6[1];//State for the modals\n//category\nvar _useState7=useState(),_useState8=_slicedToArray(_useState7,2),titleNewCtg=_useState8[0],settitleNewCtg=_useState8[1];//channel\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),titleNewCh=_useState10[0],settitleNewCh=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),topicNewCh=_useState12[0],settopicNewCh=_useState12[1];//category for new channel\nvar _useState13=useState(),_useState14=_slicedToArray(_useState13,2),ctgForNewChannel=_useState14[0],setctgForNewChannel=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),username=_useState16[0],setUsername=_useState16[1];useEffect(function(){//Check for token\nvar token=localStorage.getItem(\"token\");if(typeof props.ActiveServer!=='undefined'){getServerData(props.ActiveServer,token).then(function(response){setServerDetail(response.data);if(response.is_admin===true){setIsAdmin(true);}setDataLoaded(true);});}},[props.ActiveServer]);/// functions for modals  \nfunction ModalTrigger(parameter,category_id){//pass in parameter\nvar modal=document.getElementById(parameter);//set channel category with new category id\nsetctgForNewChannel(category_id);//display the modal\nmodal.style.display='block';}function ModalClose(parameter){var modal=document.getElementById(parameter);setctgForNewChannel('');modal.style.display='none';}var handleSubmitCategory=function handleSubmitCategory(e){e.preventDefault();//pass in new server detail/id and new title category\nCreateNewCategory(serverDetail.id,titleNewCtg).then(function(response){//add reponse to the array and close\nserverDetail.categories.push(response);ModalClose(\"add-category-modal\");});};var handleSubmitInvitation=function handleSubmitInvitation(e){e.preventDefault();//Check for token\nvar token=localStorage.getItem(\"token\");SendNewInvitation(username,serverDetail.id,token).then(function(response){//save the modal\nconsole.log(response);ModalClose(\"invite-user-modal\");});};var handleSubmitChannel=function handleSubmitChannel(e){e.preventDefault();//pass in new server detail/id, category, title and topic\nCreateNewChannel(serverDetail.id,ctgForNewChannel,titleNewCh,topicNewCh).then(function(response){//filter the category using obj through text_channels and add new channel\nserverDetail.categories.filter(function(obj){return obj.id===ctgForNewChannel;})[0]['text_channels'].push(response);ModalClose(\"add-channel-modal\");});};function handleClick(parameter,event){//to activate when click on text channel\nprops.setTextChannel(parameter);};//function for leaving server\nvar handleLeaveServer=function handleLeaveServer(e){e.preventDefault();//leave server with specific server id\nLeaveServer(serverDetail.id).then(function(response){//reload the website\nlocation.reload();});};if(dataLoaded===true){return/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",id:\"add-category-modal\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-card\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitCategory,children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Create new category or group\"}),/*#__PURE__*/_jsx(\"a\",{onClick:ModalClose.bind(this,\"add-category-modal\"),className:\"delete\",\"aria-label\":\"close\"})]}),/*#__PURE__*/_jsx(\"section\",{className:\"modal-card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Title\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{id:\"title\",type:\"text\",maxLength:\"25\",className:\"input\",name:\"titleCategory\",onChange:function onChange(e){return settitleNewCtg(e.target.value);}})})]})}),/*#__PURE__*/_jsxs(\"footer\",{className:\"modal-card-foot\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-dark\",children:\"Save changes\"}),/*#__PURE__*/_jsx(\"a\",{onClick:ModalClose.bind(this,\"add-category-modal\"),className:\"button is-light\",children:\"Cancel\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",id:\"invite-user-modal\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-card\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitInvitation,children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Invite an user\"}),/*#__PURE__*/_jsx(\"a\",{onClick:ModalClose.bind(this,\"invite-user-modal\"),className:\"delete\",\"aria-label\":\"close\"})]}),/*#__PURE__*/_jsx(\"section\",{className:\"modal-card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Username\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{id:\"userinviteipt\",type:\"text\",className:\"input\",name:\"usernameinvi\",onChange:function onChange(e){return setUsername(e.target.value);}})})]})}),/*#__PURE__*/_jsxs(\"footer\",{className:\"modal-card-foot\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-dark\",children:\"Save changes\"}),/*#__PURE__*/_jsx(\"a\",{onClick:ModalClose.bind(this,\"invite-user-modal\"),className:\"button is-light\",children:\"Cancel\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",id:\"add-channel-modal\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-card\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitChannel,children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Create new text channel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:ModalClose.bind(this,\"add-channel-modal\"),className:\"delete\",\"aria-label\":\"close\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"modal-card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Title\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"control\",children:[\"                                                                           \",/*#__PURE__*/_jsx(\"input\",{id:\"titleChannel\",type:\"text\",maxLength:\"25\",className:\"input\",name:\"titleChannel\",onChange:function onChange(e){return settitleNewCh(e.target.value);}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Topic\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{id:\"topic\",type:\"text\",maxLength:\"50\",className:\"input\",name:\"topic\",onChange:function onChange(e){return settopicNewCh(e.target.value);}})})]})]}),/*#__PURE__*/_jsxs(\"footer\",{className:\"modal-card-foot\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"button is-darlk\",children:\"Save changes\"}),/*#__PURE__*/_jsx(\"a\",{onClick:ModalClose.bind(this,\"add-channel-modal\"),className:\"button is-light\",children:\"Cancel\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"columns pt-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"column is-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-image\",children:/*#__PURE__*/_jsx(\"figure\",{className:\"image\",children:/*#__PURE__*/_jsx(\"img\",{src:serverDetail.banner,alt:\"Placeholder image\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"title is-4\",children:serverDetail.title}),/*#__PURE__*/_jsx(\"p\",{className:\"subtitle is-6\",children:serverDetail.description})]}),/*#__PURE__*/_jsxs(\"footer\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"a\",{onClick:ModalTrigger.bind(this,\"invite-user-modal\"),className:\"card-footer-item\",children:\"Invite People\"}),/*#__PURE__*/_jsx(\"a\",{onClick:handleLeaveServer,className:\"card-footer-item\",children:\"Leave server\"})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:ModalTrigger.bind(this,\"add-category-modal\"),className:\"button is-small is-dark is-rounded\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small\",children:/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",children:\"add\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Category\"})]}),serverDetail.categories.map(function(category){return/*#__PURE__*/_jsxs(\"aside\",{className:\"menu\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"menu-label\",children:category.title},category.id),/*#__PURE__*/_jsxs(\"button\",{onClick:ModalTrigger.bind(_this,\"add-channel-modal\",category.id),className:\"button is-small is-dark is-rounded\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small\",children:/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",children:\"add\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Channel\"})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"menu-list\",children:category.text_channels.map(function(text_channel){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{onClick:handleClick.bind(_this,text_channel),children:text_channel.title})},text_channel.id);})})]});})]})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-7\",children:/*#__PURE__*/_jsx(MainChat,{TextChannel:props.TextChannel,chatData:props.chatData,setchatData:props.setchatData,isAdmin:isAdmin,server:serverDetail.id})}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-2\",children:/*#__PURE__*/_jsx(Members,{members:serverDetail.members,isAdmin:isAdmin,server:serverDetail.id})})]})]});}else{return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(QuizCategories,{})});}}export default Server;","map":{"version":3,"sources":["C:/Users/Stephen/OneDrive/Desktop/PD/quizzer/frontend/src/components/layout/Server.js"],"names":["React","useState","useEffect","MainChat","Members","getServerData","CreateNewCategory","CreateNewChannel","LeaveServer","SendNewInvitation","QuizCategories","Server","props","serverDetail","setServerDetail","dataLoaded","setDataLoaded","isAdmin","setIsAdmin","titleNewCtg","settitleNewCtg","titleNewCh","settitleNewCh","topicNewCh","settopicNewCh","ctgForNewChannel","setctgForNewChannel","username","setUsername","token","localStorage","getItem","ActiveServer","then","response","data","is_admin","ModalTrigger","parameter","category_id","modal","document","getElementById","style","display","ModalClose","handleSubmitCategory","e","preventDefault","id","categories","push","handleSubmitInvitation","console","log","handleSubmitChannel","filter","obj","handleClick","event","setTextChannel","handleLeaveServer","location","reload","bind","target","value","banner","title","description","map","category","text_channels","text_channel","TextChannel","chatData","setchatData","members"],"mappings":"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","sourcesContent":["import React, {useState, useEffect } from 'react'\r\nimport MainChat from './MainChat';\r\nimport Members from './Members';\r\nimport { getServerData, CreateNewCategory, CreateNewChannel, LeaveServer } from '../services/Servers';\r\nimport { SendNewInvitation } from '../services/notifications';\r\nimport QuizCategories from '../quiz/QuizCategories.jsx';\r\n\r\nfunction Server(props) {\r\n\r\n    const [serverDetail, setServerDetail] = useState();\r\n    const [dataLoaded, setDataLoaded] = useState(false);\r\n    const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n    //State for the modals\r\n    //category\r\n    const [titleNewCtg, settitleNewCtg] = useState();\r\n    //channel\r\n    const [titleNewCh, settitleNewCh] = useState();\r\n    const [topicNewCh, settopicNewCh] = useState();\r\n    //category for new channel\r\n    const [ctgForNewChannel, setctgForNewChannel] = useState();\r\n\r\n   const [username, setUsername] = useState();\r\n\r\n\r\n\r\n    useEffect(()=> {\r\n        //Check for token\r\n        const token = localStorage.getItem(\"token\");\r\n        if(typeof props.ActiveServer !== 'undefined'){\r\n            getServerData(props.ActiveServer, token)\r\n            .then(response =>{\r\n                setServerDetail(response.data);\r\n                if (response.is_admin === true){\r\n                    setIsAdmin(true);\r\n                }\r\n                setDataLoaded(true);\r\n            })\r\n        }\r\n\r\n    }, [props.ActiveServer])\r\n\r\n\r\n/// functions for modals  \r\n  function ModalTrigger(parameter, category_id){\r\n        //pass in parameter\r\n        var modal = document.getElementById(parameter);\r\n        //set channel category with new category id\r\n        setctgForNewChannel(category_id);\r\n        //display the modal\r\n        modal.style.display = 'block';\r\n    }\r\n\r\n    function ModalClose(parameter){\r\n        var modal = document.getElementById(parameter);\r\n        setctgForNewChannel('');\r\n        modal.style.display = 'none';\r\n    }\r\n    const handleSubmitCategory = (e) => {\r\n        e.preventDefault();\r\n        //pass in new server detail/id and new title category\r\n        CreateNewCategory(serverDetail.id, titleNewCtg)\r\n        .then(response =>{\r\n          //add reponse to the array and close\r\n            serverDetail.categories.push(response);\r\n            ModalClose(\"add-category-modal\");\r\n        })\r\n    };\r\n    \r\n    const handleSubmitInvitation = (e) => {\r\n        e.preventDefault();\r\n        //Check for token\r\n        const token = localStorage.getItem(\"token\");\r\n        SendNewInvitation(username, serverDetail.id, token)\r\n        .then(response => {\r\n            //save the modal\r\n            console.log(response);\r\n            ModalClose(\"invite-user-modal\");\r\n        })\r\n    };    \r\n    \r\n    const handleSubmitChannel = (e) => {\r\n        e.preventDefault();\r\n          //pass in new server detail/id, category, title and topic\r\n        CreateNewChannel(serverDetail.id, ctgForNewChannel, titleNewCh, topicNewCh)\r\n        .then(response => {\r\n            //filter the category using obj through text_channels and add new channel\r\n            serverDetail.categories.filter(obj=>obj.id === ctgForNewChannel)[0]['text_channels'].push(response);\r\n            ModalClose(\"add-channel-modal\");\r\n        })\r\n    };\r\n    function handleClick(parameter, event){\r\n      //to activate when click on text channel\r\n        props.setTextChannel(parameter);\r\n    };\r\n\r\n    //function for leaving server\r\n    const handleLeaveServer = (e) => {\r\n        e.preventDefault();\r\n        //leave server with specific server id\r\n        LeaveServer(serverDetail.id)\r\n        .then(response =>{\r\n            //reload the website\r\n            location.reload();\r\n        })\r\n    };\r\n\r\n    if (dataLoaded === true){\r\n    return(\r\n        \r\n        <main>\r\n        {/* Modal for Group/Categories Channel Creation*/}  \r\n            <div className=\"modal\" id=\"add-category-modal\">\r\n            <div className=\"modal-background\"></div>\r\n            <div className=\"modal-card\">\r\n                <form onSubmit={handleSubmitCategory}>\r\n                <header className=\"modal-card-head\">\r\n                <p className=\"modal-card-title\">Create new category or group</p>\r\n                <a onClick={ModalClose.bind(this, \"add-category-modal\")} className=\"delete\" aria-label=\"close\"></a>\r\n                </header>\r\n                <section className=\"modal-card-body\">\r\n                    <div className=\"field\">\r\n                    <label className=\"label\">Title</label>\r\n                    <div className=\"control\">\r\n                        <input id=\"title\" type=\"text\" maxLength=\"25\" className=\"input\" name=\"titleCategory\" onChange={e => settitleNewCtg(e.target.value)} />\r\n                    </div>\r\n                    </div>\r\n                </section>\r\n                <footer className=\"modal-card-foot\">\r\n                <button type=\"submit\" className=\"button is-dark\">Save changes</button>                \r\n                {/* binding the modal when clicks for save categorys */}\r\n\r\n                <a onClick={ModalClose.bind(this, \"add-category-modal\")} className=\"button is-light\">Cancel</a>\r\n                </footer>\r\n                </form>\r\n            </div>\r\n            </div>\r\n        {/* End modal */}\r\n\r\n        {/* Modal for User invitation */}  \r\n        <div className=\"modal\" id=\"invite-user-modal\">\r\n            <div className=\"modal-background\"></div>\r\n            <div className=\"modal-card\">\r\n                <form onSubmit={handleSubmitInvitation}>\r\n                <header className=\"modal-card-head\">\r\n                <p className=\"modal-card-title\">Invite an user</p>\r\n                  {/* binding the modal when clicks to invite user*/}\r\n                <a onClick={ModalClose.bind(this, \"invite-user-modal\")} className=\"delete\" aria-label=\"close\"></a>\r\n                </header>\r\n                <section className=\"modal-card-body\">\r\n                    <div className=\"field\">\r\n                    <label className=\"label\">Username</label>\r\n                    <div className=\"control\">\r\n                        <input id=\"userinviteipt\" type=\"text\" className=\"input\" name=\"usernameinvi\" onChange={e => setUsername(e.target.value)} />\r\n                    </div>\r\n                    </div>\r\n                </section>\r\n                <footer className=\"modal-card-foot\">\r\n                <button type=\"submit\" className=\"button is-dark\">Save changes</button>\r\n                  {/* binding the modal when clicks for save changes*/}\r\n                <a onClick={ModalClose.bind(this, \"invite-user-modal\")} className=\"button is-light\">Cancel</a>\r\n                </footer>\r\n                </form>\r\n            </div>\r\n            </div>\r\n        {/* End modal */}\r\n\r\n        {/* Modal for Group/Categories Channel Creation*/}  \r\n            <div className=\"modal\" id=\"add-channel-modal\">\r\n            <div className=\"modal-background\"></div>\r\n            <div className=\"modal-card\">\r\n                <form onSubmit={handleSubmitChannel}>\r\n                <header className=\"modal-card-head\">\r\n                <p className=\"modal-card-title\">Create new text channel</p>\r\n                 {/* binding the modal when clicks*/}\r\n                <button onClick={ModalClose.bind(this, \"add-channel-modal\")} className=\"delete\" aria-label=\"close\"></button>\r\n                </header>\r\n                <section className=\"modal-card-body\">\r\n\r\n                    <div className=\"field\">\r\n                    <label className=\"label\">Title</label>\r\n                    <div className=\"control\">                                                                           {/* setting new title channel */}\r\n                        <input id=\"titleChannel\" type=\"text\" maxLength=\"25\" className=\"input\" name=\"titleChannel\" onChange={e => settitleNewCh(e.target.value)}/>\r\n                    </div>\r\n                    </div>\r\n\r\n                    <div className=\"field\">\r\n                    <label className=\"label\">Topic</label>\r\n                    <div className=\"control\">\r\n                        <input id=\"topic\" type=\"text\" maxLength=\"50\" className=\"input\" name=\"topic\" onChange={e => settopicNewCh(e.target.value)}/>\r\n                    </div>\r\n                    </div>\r\n\r\n\r\n                </section>\r\n                <footer className=\"modal-card-foot\">\r\n                <button type=\"submit\" className=\"button is-darlk\">Save changes</button>\r\n                {/* binding the modal when clicks*/}\r\n                <a onClick={ModalClose.bind(this, \"add-channel-modal\")} className=\"button is-light\">Cancel</a>\r\n                </footer>\r\n                </form>\r\n            </div>\r\n            </div>\r\n        {/* End modal */}   \r\n\r\n            <div className=\"columns pt-1\">\r\n                <div className=\"column is-2\">\r\n                    <div className=\"card\">\r\n                        <div className=\"card-image\">\r\n                        <figure className=\"image\">\r\n                            <img src={serverDetail.banner} alt=\"Placeholder image\" />\r\n                        </figure>\r\n                        </div>\r\n                        <div className=\"card-content\">\r\n                            <p className=\"title is-4\">{serverDetail.title}</p>\r\n                            <p className=\"subtitle is-6\">{serverDetail.description}</p>\r\n                        </div>\r\n                        <footer className=\"card-footer\">\r\n                            {/* using handle submit invitation modal above */}\r\n                            <a onClick={ModalTrigger.bind(this, \"invite-user-modal\")} className=\"card-footer-item\">Invite People</a>\r\n                            {/* using handle leave modal above*/}\r\n                            <a onClick={handleLeaveServer} className=\"card-footer-item\">Leave server</a>\r\n                        </footer>\r\n                    </div>\r\n\r\n                    <br></br>\r\n\r\n                    <div className=\"card\">\r\n                        <div className=\"card-content\">\r\n                            <div className=\"content\">\r\n                                <button onClick={ModalTrigger.bind(this, \"add-category-modal\")} className=\"button is-small is-dark is-rounded\">\r\n                                    <span className=\"icon is-small\">\r\n                                        <i className=\"material-icons\">add</i>\r\n                                    </span>\r\n                                    <span>Category</span>\r\n                                </button>\r\n                            \r\n                            {serverDetail.categories.map(category =>(\r\n                                <aside className=\"menu\">\r\n                                    <p key={category.id} className=\"menu-label\">{category.title}</p>\r\n\r\n                                    <button onClick={ModalTrigger.bind(this, \"add-channel-modal\", category.id)} className=\"button is-small is-dark is-rounded\">\r\n                                        <span className=\"icon is-small\">\r\n                                            <i className=\"material-icons\">add</i>\r\n                                        </span>\r\n                                        <span>Channel</span>\r\n                                    </button>\r\n\r\n                                    <ul className=\"menu-list\">\r\n                                        {/* Map out the text channels */}\r\n                                        {category.text_channels.map(text_channel =>(\r\n                                            <li key={text_channel.id}><a onClick={handleClick.bind(this, text_channel)}>{text_channel.title}</a></li>\r\n                                        ))}\r\n                                    </ul>\r\n                                </aside>\r\n                            ))}\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                {/* This is where the main chat is displayed */}\r\n                <div className=\"column is-7\">\r\n                    <MainChat TextChannel={props.TextChannel} chatData={props.chatData} setchatData={props.setchatData} isAdmin={isAdmin} server={serverDetail.id}/>\r\n                </div>\r\n\r\n                <div className=\"column is-2\">\r\n                     {/* pass the members in, check if user is admin  */}\r\n                    <Members members={serverDetail.members} isAdmin={isAdmin} server={serverDetail.id} />                  \r\n                </div>\r\n            </div>\r\n        </main>\r\n    )\r\n    } else {\r\n    return (\r\n        \r\n       <div><QuizCategories/></div>\r\n    )\r\n    }\r\n}\r\n\r\nexport default Server"]},"metadata":{},"sourceType":"module"}